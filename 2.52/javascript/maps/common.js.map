{"version":3,"sources":["common.js"],"names":["setInnerHTML","e","html","currentHTML","innerHTML","sanitizeText","text","replace","setTextContent","textContent","Prefs","parseUri","str","o","options","m","parser","strictMode","exec","uri","i","key","q","name","$0","$1","$2","transmission","dialog","isMobileDevice","RegExp","test","navigator","userAgent","scroll_timeout","Array","indexOf","prototype","obj","len","this","length","$","fn","tabbedDialog","dialog_opts","tabs","selected","find","append","parent","css","position","right","top","float","padding","tabul","addClass","prepend","draggable","siblings","remove","document","ready","Date","now","browser","msie","execCommand","err","window","height","safari","onload","setTimeout","scrollTo","onorientationchange","standalone","Dialog","Transmission","Math","ratio","numerator","denominator","result","floor","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","isNaN","toTruncFixed","place","ret","pow","toFixed","toStringWithCommas","toString","String","trim","_RefreshRate","_FilterMode","_FilterAll","_FilterActive","_FilterSeeding","_FilterDownloading","_FilterPaused","_FilterFinished","_SortDirection","_SortAscending","_SortDescending","_SortMethod","_SortByAge","_SortByActivity","_SortByName","_SortByQueue","_SortBySize","_SortByProgress","_SortByRatio","_SortByState","_CompactDisplayState","_Defaults","filter","refresh_rate","sort_direction","sort_method","turtle-state","compact_display_state","setValue","val","console","warn","days","date","setTime","getTime","cookie","toGMTString","getValue","fallback","lines","split","line","delim","substring","getClutchPrefs","jQuery","forceNumeric","each","keydown","which","keyCode","shiftKey","altKey","ctrlKey","strict","loose"],"mappings":"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","file":"common.js","sourcesContent":["/**\n * Copyright © Dave Perrett and Malcolm Jarvis\n *\n * This file is licensed under the GPLv2.\n * http://www.gnu.org/licenses/old-licenses/gpl-2.0.html\n */\n\nvar transmission,\n    dialog,\n    isMobileDevice = RegExp(\"(iPhone|iPod|Android)\").test(navigator.userAgent),\n    scroll_timeout;\n\nif (!Array.indexOf){\n\tArray.prototype.indexOf = function(obj){\n\t\tvar i, len;\n\t\tfor (i=0, len=this.length; i<len; i++)\n\t\t\tif (this[i]==obj)\n\t\t\t\treturn i;\n\t\treturn -1;\n\t}\n}\n\n// http://forum.jquery.com/topic/combining-ui-dialog-and-tabs\n$.fn.tabbedDialog = function (dialog_opts) {\n\tthis.tabs({selected: 0});\n\tthis.dialog(dialog_opts);\n\tthis.find('.ui-tab-dialog-close').append(this.parent().find('.ui-dialog-titlebar-close'));\n\tthis.find('.ui-tab-dialog-close').css({'position':'absolute','right':'0', 'top':'16px'});\n\tthis.find('.ui-tab-dialog-close > a').css({'float':'none','padding':'0'});\n\tvar tabul = this.find('ul:first');\n\tthis.parent().addClass('ui-tabs').prepend(tabul).draggable('option','handle',tabul); \n\tthis.siblings('.ui-dialog-titlebar').remove();\n\ttabul.addClass('ui-dialog-titlebar');\n}\n\n$(document).ready(function() {\n\n\t// IE8 and below don’t support ES5 Date.now()\n\tif (!Date.now) {\n\t\tDate.now = function() {\n\t\t\treturn +new Date();\n\t\t};\n\t}\n\n\t// IE specific fixes here\n\tif ($.browser.msie) {\n\t\ttry {\n\t\t\tdocument.execCommand(\"BackgroundImageCache\", false, true);\n\t\t} catch(err) {}\n\t\t$('.dialog_container').css('height',$(window).height()+'px');\n\t}\n\n\tif ($.browser.safari) {\n\t\t// Move search field's margin down for the styled input\n\t\t// $('#torrent_search').css('margin-top', 3);\n\t}\n\tif (isMobileDevice){\n\t\twindow.onload = function(){ setTimeout(function() { window.scrollTo(0,1); },500); };\n\t\twindow.onorientationchange = function(){ setTimeout(function() { window.scrollTo(0,1); },100); };\n\t\tif (window.navigator.standalone)\n\t\t\t// Fix min height for isMobileDevice when run in full screen mode from home screen\n\t\t\t// so the footer appears in the right place\n\t\t\t$('body div#torrent_container').css('min-height', '338px');\n\t\t$(\"label[for=torrent_upload_url]\").text(\"URL: \");\n\t} else {\n\t\t// Fix for non-Safari-3 browsers: dark borders to replace shadows.\n\t\t// Opera messes up the menu if we use a border on .trans_menu\n\t\t// div.outerbox so use ul instead\n\t\t$('.trans_menu ul, div#jqContextMenu, div.dialog_container div.dialog_window');\n\t\t// and this kills the border we used to have\n\t\t$('.trans_menu div.outerbox').css('border', 'none');\n\t}\n\n\t// Initialise the dialog controller\n\tdialog = new Dialog();\n\n\t// Initialise the main Transmission controller\n\ttransmission = new Transmission();\n});\n\n/**\n * Checks to see if the content actually changed before poking the DOM.\n */\nfunction setInnerHTML(e, html)\n{\n\tif (!e)\n\t\treturn;\n\n\t/* innerHTML is listed as a string, but the browser seems to change it.\n\t * For example, \"&infin;\" gets changed to \"∞\" somewhere down the line.\n\t * So, let's use an arbitrary  different field to test our state... */\n\tif (e.currentHTML != html)\n\t{\n\t\te.currentHTML = html;\n\t\te.innerHTML = html;\n\t}\n};\n\nfunction sanitizeText(text)\n{\n\treturn text.replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n};\n\n/**\n * Many of our text changes are triggered by periodic refreshes\n * on torrents whose state hasn't changed since the last update,\n * so see if the text actually changed before poking the DOM.\n */\nfunction setTextContent(e, text)\n{\n\tif (e && (e.textContent != text))\n\t\te.textContent = text;\n};\n\n/*\n *   Given a numerator and denominator, return a ratio string\n */\nMath.ratio = function(numerator, denominator) {\n\tvar result = Math.floor(100 * numerator / denominator) / 100;\n\n\t// check for special cases\n\tif (result==Number.POSITIVE_INFINITY || result==Number.NEGATIVE_INFINITY) result = -2;\n\telse if (isNaN(result)) result = -1;\n\n\treturn result;\n};\n\n/**\n * Round a string of a number to a specified number of decimal places\n */\nNumber.prototype.toTruncFixed = function(place) {\n\tvar ret = Math.floor(this * Math.pow (10, place)) / Math.pow(10, place);\n\treturn ret.toFixed(place);\n}\n\nNumber.prototype.toStringWithCommas = function() {\n    return this.toString().replace(/\\B(?=(?:\\d{3})+(?!\\d))/g, \",\");\n}\n\n\n/*\n * Trim whitespace from a string\n */\nString.prototype.trim = function () {\n\treturn this.replace(/^\\s*/, \"\").replace(/\\s*$/, \"\");\n}\n\n/***\n****  Preferences\n***/\n\nfunction Prefs() { }\nPrefs.prototype = { };\n\nPrefs._RefreshRate        = 'refresh_rate';\n\nPrefs._FilterMode         = 'filter';\nPrefs._FilterAll          = 'all';\nPrefs._FilterActive       = 'active';\nPrefs._FilterSeeding      = 'seeding';\nPrefs._FilterDownloading  = 'downloading';\nPrefs._FilterPaused       = 'paused';\nPrefs._FilterFinished     = 'finished';\n\nPrefs._SortDirection      = 'sort_direction';\nPrefs._SortAscending      = 'ascending';\nPrefs._SortDescending     = 'descending';\n\nPrefs._SortMethod         = 'sort_method';\nPrefs._SortByAge          = 'age';\nPrefs._SortByActivity     = 'activity';\nPrefs._SortByName         = 'name';\nPrefs._SortByQueue        = 'queue_order';\nPrefs._SortBySize         = 'size';\nPrefs._SortByProgress     = 'percent_completed';\nPrefs._SortByRatio        = 'ratio';\nPrefs._SortByState        = 'state';\n\nPrefs._CompactDisplayState= 'compact_display_state';\n\nPrefs._Defaults =\n{\n\t'filter': 'all',\n\t'refresh_rate' : 5,\n\t'sort_direction': 'ascending',\n\t'sort_method': 'name',\n\t'turtle-state' : false,\n\t'compact_display_state' : false\n};\n\n/*\n * Set a preference option\n */\nPrefs.setValue = function(key, val)\n{\n\tif (!(key in Prefs._Defaults))\n\t\tconsole.warn(\"unrecognized preference key '%s'\", key);\n\n\tvar days = 30;\n\tvar date = new Date();\n\tdate.setTime(date.getTime()+(days*24*60*60*1000));\n\tdocument.cookie = key+\"=\"+val+\"; expires=\"+date.toGMTString()+\"; path=/\";\n};\n\n/**\n * Get a preference option\n *\n * @param key the preference's key\n * @param fallback if the option isn't set, return this instead\n */\nPrefs.getValue = function(key, fallback)\n{\n\tvar val;\n\n\tif (!(key in Prefs._Defaults))\n\t\tconsole.warn(\"unrecognized preference key '%s'\", key);\n\n\tvar lines = document.cookie.split(';');\n\tfor (var i=0, len=lines.length; !val && i<len; ++i) {\n\t\tvar line = lines[i].trim();\n\t\tvar delim = line.indexOf('=');\n\t\tif ((delim === key.length) && line.indexOf(key) === 0)\n\t\t\tval = line.substring(delim + 1);\n\t}\n\n\t// FIXME: we support strings and booleans... add number support too?\n\tif (!val) val = fallback;\n\telse if (val === 'true') val = true;\n\telse if (val === 'false') val = false;\n\treturn val;\n};\n\n/**\n * Get an object with all the Clutch preferences set\n *\n * @pararm o object to be populated (optional)\n */\nPrefs.getClutchPrefs = function(o)\n{\n\tif (!o)\n\t\to = { };\n\tfor (var key in Prefs._Defaults)\n\t\to[key] = Prefs.getValue(key, Prefs._Defaults[key]);\n\treturn o;\n};\n\n\n// forceNumeric() plug-in implementation\njQuery.fn.forceNumeric = function () {\n\treturn this.each(function () {\n\t\t$(this).keydown(function (e) {\n\t\t\tvar key = e.which || e.keyCode;\n\t\t\treturn !e.shiftKey && !e.altKey && !e.ctrlKey &&\n\t\t\t\t// numbers   \n\t\t\t\tkey >= 48 && key <= 57 ||\n\t\t\t\t// Numeric keypad\n\t\t\t\tkey >= 96 && key <= 105 ||\n\t\t\t\t// comma, period and minus, . on keypad\n\t\t\t\tkey === 190 || key === 188 || key === 109 || key === 110 ||\n\t\t\t\t// Backspace and Tab and Enter\n\t\t\t\tkey === 8 || key === 9 || key === 13 ||\n\t\t\t\t// Home and End\n\t\t\t\tkey === 35 || key === 36 ||\n\t\t\t\t// left and right arrows\n\t\t\t\tkey === 37 || key === 39 ||\n\t\t\t\t// Del and Ins\n\t\t\t\tkey === 46 || key === 45;\n\t\t});\n\t});\n}\n\n\n/**\n * http://blog.stevenlevithan.com/archives/parseuri\n *\n * parseUri 1.2.2\n * (c) Steven Levithan <stevenlevithan.com>\n * MIT License\n */\nfunction parseUri (str) {\n\tvar\to   = parseUri.options,\n\t\tm   = o.parser[o.strictMode ? \"strict\" : \"loose\"].exec(str),\n\t\turi = {},\n\t\ti   = 14;\n\n\twhile (i--) uri[o.key[i]] = m[i] || \"\";\n\n\turi[o.q.name] = {};\n\turi[o.key[12]].replace(o.q.parser, function ($0, $1, $2) {\n\t\tif ($1) uri[o.q.name][$1] = $2;\n\t});\n\n\treturn uri;\n};\n\nparseUri.options = {\n\tstrictMode: false,\n\tkey: [\"source\",\"protocol\",\"authority\",\"userInfo\",\"user\",\"password\",\"host\",\"port\",\"relative\",\"path\",\"directory\",\"file\",\"query\",\"anchor\"],\n\tq:   {\n\t\tname:   \"queryKey\",\n\t\tparser: /(?:^|&)([^&=]*)=?([^&]*)/g\n\t},\n\tparser: {\n\t\tstrict: /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,\n\t\tloose:  /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/\n\t}\n};\n"],"sourceRoot":"/source/"}