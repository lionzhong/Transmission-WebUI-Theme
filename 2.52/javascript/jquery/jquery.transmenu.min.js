!function(e){var i,t={onClick:function(){e(this).find(">a").each(function(){this.href&&(window.location=this.href)})},arrow_char:"&#x25BA;",selected_char:"&#x2713;",subDelay:300,direction:"down",mainDelay:10};e.fn.transMenu=function(n){var s=!1,r=2;i=e.extend({},t,n);var o=function(t,n){if(t.timer&&!t.isVisible)clearTimeout(t.timer);else if(t.timer)return;t.isVisible&&(t.timer=setTimeout(function(){e(t).find("ul li").unbind("mouseover",h).unbind("mouseout",d).unbind("click",i.onClick),e(t).hide(),t.isVisible=!1,t.timer=null},n))},a=function(t,n){t.timer&&clearTimeout(t.timer),t.isVisible||(t.timer=setTimeout(function(){e(t).parent().is(".hover")&&(e(t).find("ul li").mouseover(h).mouseout(d).click(i.onClick),e(t).parent().is(".main")||e(t).css("left",e(t).parent().parent().width()-r),"up"==i.direction&&e(t).css("top",e(t).height()*-1+e(t).parent().parent().height()),t.isVisible=!0,e(t).show(),t.timer=null)},n))},l=function(e){for(var i=("mouseover"==e.type?e.fromElement:e.toElement)||e.relatedTarget;i&&i!=this;)try{i=i.parentNode}catch(e){i=this}return i!=this},u=function(t){e(this).addClass("hover").siblings("li.hover").removeClass("hover"),s&&c(this,i.mainDelay)},h=function(e){return!!l(e)&&void((e.target==this||g(this,e.target))&&c(this,i.subDelay))},c=function(i,t){for(var n=i.parentNode.firstChild;n;n=n.nextSibling)if(1==n.nodeType&&"LI"==n.nodeName.toUpperCase()){var s=b(n,"DIV");s&&s.timer&&!s.isVisible&&(clearTimeout(s.timer),s.timer=null)}for(var r=i.parentNode;r;r=r.parentNode)1==r.nodeType&&"DIV"==r.nodeName.toUpperCase()&&r.timer&&(clearTimeout(r.timer),r.timer=null,e(r.parentNode).addClass("hover"));e(i).addClass("hover");var l=e(i).children("div");if(l=l.length?l[0]:null,l&&l.isVisible){if(!l.timer)return;clearTimeout(l.timer),l.timer=null}e(i.parentNode.getElementsByTagName("DIV")).each(function(){this!=l&&this.isVisible&&(o(this,t),e(this.parentNode).removeClass("hover"))}),l&&a(l,t)},d=function(i){if(!l(i))return!1;if(i.target==this||g(this,i.target)){var t=b(this,"DIV");t?t.isVisible||e(this).removeClass("hover"):e(this).removeClass("hover")}},m=function(i){var t,n=b(this,"DIV"),r=i.relatedTarget||i.toElement;s?!n&&r?(t=e(i.target).parents("UL.trans_menu"),t.contains(r)&&e(this).removeClass("hover")):r&&(t=e(i.target).parents("UL.trans_menu"),!n.isVisible&&t.contains(r)&&e(this).removeClass("hover")):e(this).removeClass("hover")},f=function(){var t=b(this,"DIV");t&&t.isVisible?(p(),e(this).addClass("hover")):(c(this,i.mainDelay),s=!0,e("ul.trans_menu li").addClass("active"),e(document).bind("mousedown",v))},v=function(i){var t=!1;e(i.target).parents("UL.trans_menu").find("div").each(function(){this.isVisible&&(t=!0)}),t||p()},p=function(){e("ul.trans_menu div.outerbox").each(function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.isVisible&&(e(this).hide(),this.isVisible=!1)}),e("ul.trans_menu li").removeClass("hover"),e("ul.trans_menu>li li").unbind("mouseover",h).unbind("mouseout",d).unbind("click",i.onClick),e(document).unbind("mousedown",v),s=!1,e("ul.trans_menu li").removeClass("active")},b=function(e,i){if(!e)return null;for(var t=e.firstChild;t;t=t.nextSibling)if(1==t.nodeType&&t.nodeName.toUpperCase()==i)return t;return null},g=function(e,i){for(var t=e.firstChild;t;t=t.nextSibling)if(t==i)return!0;return!1};return this.each(function(){window.Node&&Node.prototype&&!Node.prototype.contains&&(Node.prototype.contains=function(e){return!!(16&this.compareDocumentPosition(e))}),e(this).is(".trans_menu")||e(this).addClass("trans_menu"),e("ul",this).shadowBox(),e(this).bind("closemenu",function(){p()});for(var t=e(this).children("li"),n=0;n<t.length;n++)b(b(b(t[n],"DIV"),"UL"),"LI")&&e(t[n]).click(f);if(e(t).hover(u,m).addClass("main").find(">div").addClass("inner"),i.arrow_char){var s=e("<span class='arrow'>"+i.arrow_char+"</span>");e.browser.mozilla&&+e.browser.version.replace(/\./g,"").slice(0,3)<191&&s.css("margin-top","-13px"),e("div.inner div.outerbox",this).before(s)}e(this).wrap('<div class="main_container"></div>'),$(".main_container").prepend('<span class="icon-settings"></span>')})},e.fn.transMenu.setDefaults=function(i){e.extend(t,i)},e.fn.shadowBox=function(){return this.each(function(){var i=e('<div class="outerbox"></div>').get(0);"absolute"==e(this).css("position")?e(i).css({position:"relative",width:this.offsetWidth,height:this.offsetHeight}):e(i).css("position","absolute"),e(this).addClass("innerBox").wrap(i).before('<div class="shadowbox1"></div><div class="shadowbox2"></div><div class="shadowbox3"></div>')})},e.fn.selectMenuItem=function(){return 0==this.find("span.selected").length&&this.prepend(e("<span class='selected'>"+i.selected_char+"</span>")),this},e.fn.deselectMenuItem=function(){return this.find("span.selected").remove()},e.fn.menuItemIsSelected=function(){return this.find("span.selected").length>0},e.fn.deselectMenuSiblings=function(){return this.parent().find("span.selected").remove(),this.selectMenuItem(),this}}(jQuery);