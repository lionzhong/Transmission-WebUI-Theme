function TorrentRendererHelper(){}function TorrentRendererFull(){}function TorrentRendererCompact(){}function TorrentRow(e,t,r){this.initialize(e,t,r)}TorrentRendererHelper.getProgressInfo=function(e,t){var r,n,o=t.getStatus(),s=t.seedRatioLimit(e);return r=t.needsMetaData()?100*t.getMetadataPercentComplete():t.isDone()?s>0&&t.isSeeding()?Math.round(100*t.getUploadRatio()/s):100:Math.round(100*t.getPercentDone()),n=o===Torrent._StatusStopped?"paused":o===Torrent._StatusDownloadWait?"leeching queued":t.needsMetaData()?"magnet":o===Torrent._StatusDownload?"leeching":o===Torrent._StatusSeedWait?"seeding queued":o===Torrent._StatusSeed?"seeding":"",{percent:r,complete:["torrent_progress_bar","complete",n].join(" "),incomplete:["torrent_progress_bar","incomplete",n].join(" ")}},TorrentRendererHelper.createProgressbar=function(e){var t,r,n;return t=document.createElement("div"),t.className="torrent_progress_bar complete",r=document.createElement("div"),r.className="torrent_progress_bar incomplete",n=document.createElement("div"),n.className="torrent_progress_bar_container "+e,n.appendChild(t),n.appendChild(r),{element:n,complete:t,incomplete:r}},TorrentRendererHelper.renderProgressbar=function(e,t,r){var n,o,s,a,i=TorrentRendererHelper.getProgressInfo(e,t);n=r.complete,o=n.style,s=""+i.percent+"%",a=i.percent>0?"block":"none",o.width===s&&o.display===a||$(n).css({width:""+i.percent+"%",display:a}),n.className!==i.complete&&(n.className=i.complete),n=r.incomplete,a=i.percent<100?"block":"none",n.style.display!==a&&(n.style.display=a),n.className!==i.incomplete&&(n.className=i.incomplete)},TorrentRendererHelper.formatUL=function(e){return"上传速度："+Transmission.fmt.speedBps(e.getUploadSpeed())},TorrentRendererHelper.formatDL=function(e){return"下载速度："+Transmission.fmt.speedBps(e.getDownloadSpeed())},TorrentRendererFull.prototype={createRow:function(){var e,t,r,n,o,s,a;return e=document.createElement("li"),e.className="torrent",t=document.createElement("div"),t.className="torrent_name",r=document.createElement("div"),r.className="torrent_peer_details",n=TorrentRendererHelper.createProgressbar("full"),o=document.createElement("div"),o.className="torrent_progress_details",s=document.createElement("div"),a=document.createElement("a"),a.appendChild(s),e.appendChild(t),e.appendChild(r),e.appendChild(a),e.appendChild(n.element),e.appendChild(o),e._name_container=t,e._peer_details_container=r,e._progress_details_container=o,e._progressbar=n,e._pause_resume_button_image=s,e._toggle_running_button=a,e},getPeerDetails:function(e){var t;return(t=e.getErrorMessage())?t:e.isDownloading()?["下载中",e.getPeersSendingToUs()," / ",e.getPeersConnected(),"peers","-",TorrentRendererHelper.formatDL(e),TorrentRendererHelper.formatUL(e)].join(" "):e.isSeeding()?["做种中：",e.getPeersGettingFromUs()," / ",e.getPeersConnected(),"peers"," - ",TorrentRendererHelper.formatUL(e)].join(" "):e.isChecking()?["验证本地数据中 (",Transmission.fmt.percentString(100*e.getRecheckProgress()),"% tested)"].join(""):e.getStateString()},getProgressDetails:function(e,t){if(t.needsMetaData()){var r=100*t.getMetadataPercentComplete();return["Magnetized transfer - retrieving metadata (",Transmission.fmt.percentString(r),"%)"].join("")}var n,o=t.getSizeWhenDone(),s=t.getTotalSize(),a=t.isDone()||t.isSeeding();if(a?(n=s===o?[Transmission.fmt.size(s)]:[Transmission.fmt.size(o)," of ",Transmission.fmt.size(t.getTotalSize())," (",t.getPercentDoneStr(),"%)"],n.push(", 已上传 ",Transmission.fmt.size(t.getUploadedEver())," (分享率 ",Transmission.fmt.ratioString(t.getUploadRatio()),")")):n=["已下载：",Transmission.fmt.size(o-t.getLeftUntilDone())," / ",Transmission.fmt.size(o)," (",t.getPercentDoneStr(),"%)"],!t.isStopped()&&(!a||t.seedRatioLimit(e)>0)){n.push(" - ");var i=t.getETA();i<0||i>=3596400?n.push("未知剩余时长"):n.push(Transmission.fmt.timeInterval(t.getETA())," 剩余时长")}return n.join("")},render:function(e,t,r){setTextContent(r._name_container,t.getName()),TorrentRendererHelper.renderProgressbar(e,t,r._progressbar);var n=t.getError()!==Torrent._ErrNone,o=r._peer_details_container;$(o).toggleClass("error",n),setTextContent(o,this.getPeerDetails(t)),o=r._progress_details_container,setTextContent(o,this.getProgressDetails(e,t));var s=t.isStopped();o=r._pause_resume_button_image,o.alt=s?"Resume":"Pause",o.className=s?"torrent_resume":"torrent_pause"}},TorrentRendererCompact.prototype={createRow:function(){var e,t,r,n;return e=TorrentRendererHelper.createProgressbar("compact"),t=document.createElement("div"),t.className="torrent_peer_details compact",r=document.createElement("div"),r.className="torrent_name compact",n=document.createElement("li"),n.appendChild(e.element),n.appendChild(t),n.appendChild(r),n.className="torrent compact",n._progressbar=e,n._details_container=t,n._name_container=r,n},getPeerDetails:function(e){var t;if(t=e.getErrorMessage())return t;if(e.isDownloading()){var r=e.getDownloadSpeed()>0,n=e.getUploadSpeed()>0;if(!n&&!r)return"Idle";var o="";return r&&(o+=TorrentRendererHelper.formatDL(e)),r&&n&&(o+=" "),n&&(o+=TorrentRendererHelper.formatUL(e)),o}return e.isSeeding()?["Ratio: ",Transmission.fmt.ratioString(e.getUploadRatio()),", ",TorrentRendererHelper.formatUL(e)].join(""):e.getStateString()},render:function(e,t,r){var n=t.isStopped(),o=r._name_container;$(o).toggleClass("paused",n),setTextContent(o,t.getName());var s=t.getError()!==Torrent._ErrNone;o=r._details_container,$(o).toggleClass("error",s),setTextContent(o,this.getPeerDetails(t)),TorrentRendererHelper.renderProgressbar(e,t,r._progressbar)}},TorrentRow.prototype={initialize:function(e,t,r){var n=this;this._view=e,this._torrent=r,this._element=e.createRow(),this.render(t),$(this._torrent).bind("dataChanged.torrentRowListener",function(){n.render(t)})},getElement:function(){return this._element},render:function(e){var t=this.getTorrent();t&&this._view.render(e,t,this.getElement())},isSelected:function(){return this.getElement().className.indexOf("selected")!==-1},setSelected:function(e){$(this.getElement()).toggleClass("selected",e)},getToggleRunningButton:function(){return this.getElement()._toggle_running_button},getTorrent:function(){return this._torrent},getTorrentId:function(){return this.getTorrent().getId()}};